# Cookbook Name:: install_odoo
# Recipe:: postgresql
#
# Copyright (c) 2016 Michael Doederlein, All Rights Reserved.

# Install postgresql client and server

include_recipe 'postgresql::server'
include_recipe 'postgresql::client'

# connection info to create user
postgresql_connection_info = {
  :host     => '127.0.0.1',
  :port     => node['postgresql']['config']['port'],
  :username => 'postgres',
  :password => node['postgresql']['password']['postgres']
}

# Create a mysql user but grant no privileges
mysql_database_user 'odoo' do
  connection mysql_connection_info
  password   'super_secret'
  action     :create
end

postgresql_database_user 'odoo' do
  connection postgresql_connection_info
  password   'super_secret'
  privileges [:all]
  action     [:create, :grant]
end
